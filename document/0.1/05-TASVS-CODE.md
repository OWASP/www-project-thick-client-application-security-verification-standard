# TASVS-CODE: Code Quality and Exploit Mitigation

## Control Objective

To ensure that the application's source code is developed and maintained in a manner that minimizes the introduction of security vulnerabilities. 

## Testing Checklist


| TASVS-ID        | Description                                                                                                                                                                                                                                                                                    | L1 | L2 | L3 |
| ---- | ------------- | - | - | - |
| TASVS-CODE-1    | Server Side                                                                                                                                                                                                                                                                                    |    |    |    |
| TASVS-CODE-1.1  | If the thick client relies on server side API's or services, defer that testing to the appropriate application security verification standard (ASVS). If testing has begun using that guide, mark this item as reviewed.                                                                       | X  | X  | X  |
| TASVS-CODE-2    | Client Side - Signing and Integrity                                                                                                                                                                                                                                                            |    |    |    |
| TASVS-CODE-2.1  | Making Sure that the thick client binary is properly signed                                                                                                                                                                                                                                    | X  | X  | X  |
| TASVS-CODE-2.2  | Testing File Integrity Checks                                                                                                                                                                                                                                                                  | X  | X  | X  |
| TASVS-CODE-2.3  | Testing Runtime Integrity Checks                                                                                                                                                                                                                                                               | X  | X  | X  |
| TASVS-CODE-2.4  | The client has been built in release mode, with settings appropriate for a release build.                                                                                                                                                                                                      | X  | X  | X  |
| TASVS-CODE-2.5  | Enable framework applicable security features like byte-code minification and stack protection.                                                                                                                                                                                                | X  | X  | X  |
| TASVS-CODE-3    | Client Side - Static Code Analysis                                                                                                                                                                                                                                                             |    |    |    |
| TASVS-CODE-3.1  | All third party components used by the thick client, such as libraries and frameworks, are identified, and checked for known vulnerabilities and are up to date, they should not be unsupported, deprecated or legacy.                                                                         | X  | X  | X  |
| TASVS-CODE-3.2  | Search the source code for cases where exceptions are thrown and not properly handled. E.g for C# use 'findstr /N /s /c:"throw;" \*.cs'. Also be on the lookout to see if the exception allows a bypass of authentication or some other critical operation.                                    | X  | X  | X  |
| TASVS-CODE-3.3  | Perform binary static analysis. (verify that the binaries are compiled with the latest compiler, examine compilation settings and validates binary signing)                                                                                                                                    | X  | X  | X  |
| TASVS-CODE-3.4  | Depending on the language(s) in use, choose appropriate static application security testing (SAST) tooling to analyze source code to identify vulnerabilities.                                                                                                                                 | X  | X  | X  |
| TASVS-CODE-3.5  | If applicable, ensure any internal tooling, policies and test cases are being implemented and evaluated correctly.                                                                                                                                                                             | X  | X  | X  |
| TASVS-CODE-3.6  | Identify and clear out any unused code. Remember, it stays in the source code repository history if needed later. Use README/changelog files for preserving high value historical context or deprecated details. Do not keep obsolete project repositories, consider archiving the repository. | X  | X  | X  |
| TASVS-CODE-4    | Client Side - Validation, Sanitization and Encoding                                                                                                                                                                                                                                            |    |    |    |
| TASVS-CODE-4.1  | Untrusted data through features such as macros or templating is protected from code & command injection attacks. Where there is no alternative, any user input being included must be sanitized or sandboxed before being executed.                                                            | X  | X  | X  |
| TASVS-CODE-4.2  | Verify that the application protects against OS command injection.                                                                                                                                                                                                                             | X  | X  | X  |
| TASVS-CODE-4.3  | Verify that unstructured data is sanitized to enforce safety measures such as allowed characters and length.                                                                                                                                                                                   | X  | X  | X  |
| TASVS-CODE-4.4  | Verify that the application correctly restricts XML parsers to only use the most restrictive configuration possible and to ensure that unsafe features such as resolving external entities are disabled to prevent XML eXternal Entity (XXE) attacks.                                          | X  | X  | X  |
| TASVS-CODE-4.5  | Verify that the application uses memory-safe string, safer memory copy and pointer arithmetic to detect or prevent stack, buffer, or heap overflows.                                                                                                                                           | X  | X  | X  |
| TASVS-CODE-4.6  | Verify that format strings do not take potentially hostile input, and are constant.                                                                                                                                                                                                            | X  | X  | X  |
| TASVS-CODE-4.7  | Verify that sign, range, and input validation techniques are used to prevent integer overflows.                                                                                                                                                                                                | X  | X  | X  |
| TASVS-CODE-4.8  | Verify that serialized objects use integrity checks or are encrypted to prevent hostile object creation or data tampering.                                                                                                                                                                     | X  | X  | X  |
| TASVS-CODE-4.9  | Verify that deserialization of untrusted data is avoided or is protected in both custom code and third-party libraries (such as JSON, XML and YAML parsers).                                                                                                                                   | X  | X  | X  |
| TASVS-CODE-4.10 | Is the thick client's handling of spawning processes done securely. (Validating and sanitizing process arguments)                                                                                                                                                                              | X  | X  | X  |
| TASVS-CODE-4.11 | Verify that user-submitted filename metadata is not used directly by system or framework filesystems to protect against path traversal. One example is "ZipSlip" style attacks.                                                                                                                | X  | X  | X  |
| TASVS-CODE-4.12 | In unmanaged code, memory is allocated, freed and used securely.                                                                                                                                                                                                                               | X  | X  | X  |
| TASVS-CODE-5    | Client Side - Business Logic                                                                                                                                                                                                                                                                   |    |    |    |
| TASVS-CODE-5.1  | No sensitive data, such as passwords or pins, is exposed through the user interface.                                                                                                                                                                                                           | X  | X  | X  |
| TASVS-CODE-5.2  | Check for design practices that trick or manipulate users into making choices they would not otherwise have made and that may cause harm. AKA "deceptive patterns". See https://www.deceptive.design/types for examples.                                                                       | X  | X  | X  |
| TASVS-CODE-5.3  | Is the thick client only using workflows that do not violate common security advice?                                                                                                                                                                                                           | X  | X  | X  |
| TASVS-CODE-5.4  | Verify that the attack surface is reduced by sandboxing or encapsulating third party libraries to expose only the required behaviour into the application.                                                                                                                                     | X  | X  | X  |
| TASVS-CODE-5.5  | Check that import files cannot be abused in                                                                                                                                                                                                                                                    | X  | X  | X  |
| TASVS-CODE-5.6  | If the thick client registers a URL handler / protocol handler, verify that it can't trigger dangerous action or introduces common vulnerabilities (memory corruption, command and argument injection, etc.)                                                                                   | X  | X  | X  |
| TASVS-CODE-6    | Client Side - Fuzzing                                                                                                                                                                                                                                                                          |    |    |    |
| TASVS-CODE-6.1  | Perform "dumb fuzzing" of the application with randomised input to try to cause a crash.                                                                                                                                                                                                       | X  | X  | X  |
| TASVS-CODE-6.2  | Perform "smart fuzzing". Intelligently generate test cases that maximize code coverage and explore complex program states to increasing the likelihood of finding vulnerabilities over "dumb fuzzing".                                                                                         |    |    | X  |
| TASVS-CODE-7    | Client Side - Privilege and Rule of two                                                                                                                                                                                                                                                        |    |    |    |
| TASVS-CODE-7.1  | Ensure that the software follows the principle of least privileges and runs with the lowest level of privileges for it to work as expected. If several levels of privileges are required, their IPC interfaces are well-defined and do not expose more features than required.                 | X  | X  | X  |
| TASVS-CODE-7.2  | The thick client follows the "Rule of 2", where it cannot have more than 2 of: works with untrustworthy inputs, is written in memory unsafe language, runs with high privileges / without a sandbox.                                                                                           | X  | X  | X  |

\newpage{}